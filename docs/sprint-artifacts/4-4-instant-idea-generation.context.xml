<story-context id="docs/sprint-artifacts/4-4-instant-idea-generation.context.xml" v="1.0">
  <metadata>
    <epicId>4</epicId>
    <storyId>4</storyId>
    <title>Instant Idea Generation</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-12-01</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/4-4-instant-idea-generation.md</sourceStoryPath>
  </metadata>
  <story>
    <asA>a user</asA>
    <iWant>to quickly get a recipe suggestion by typing a few ingredients, without affecting my persistent inventory</iWant>
    <soThat>I can get an instant meal idea.</soThat>
    <tasks>
        - [ ] **Task 1: Ensure Main Screen UI is Ready** (AC: #1)
        - [ ] Verify that the main screen is available and ready for the "Instant Idea" button placement.
        - [ ] **Task 2: Create "Instant Idea" Button Component** (AC: #2)
        - [ ] Create a new reusable component for the "Instant Idea" button.
        - [ ] Style the button as a primary call-to-action as per the UX specification.
        - [ ] Place the button on the main dashboard screen.
        - [ ] Add unit tests for the button component.
        - [ ] **Task 3: Implement Ingredient Input Modal** (AC: #3)
        - [ ] Create a modal that opens when the "Instant Idea" button is clicked.
        - [ ] The modal should contain a text input field for ingredients and a "Get Idea" button.
        - [ ] Implement a "Live Search" pattern for ingredient input if possible.
        - [ ] Add unit tests for the modal component.
        - [ ] **Task 4: Integrate with Gemini API** (AC: #4)
        - [ ] Create a new API route (`/api/recipes/instant-idea`) to handle the request.
        - [ ] This route will call the Google Gemini API with the user-provided ingredients.
        - [ ] The prompt to Gemini should be engineered to return a simple, clear recipe.
        - [ ] Add integration tests for the API route, mocking the Gemini API call.
        - [ ] **Task 5: Display AI-Generated Recipe** (AC: #4)
        - [ ] Create a component to display the recipe returned by the Gemini API.
        - [ ] This could be a new modal or a dedicated section on the page.
        - [ ] The display should be clean and easy to read, showing ingredients and instructions.
        - [ ] Add unit tests for the recipe display component.
        - [ ] **Task 6: Ensure No Inventory Modification** (AC: #5)
        - [ ] Verify that the "Instant Idea" flow does not interact with the user's inventory data.
        - [ ] Add a test to confirm that no inventory deduction occurs.
    </tasks>
  </story>
  <acceptanceCriteria>
    1. **Given** I am on the main screen
    2. **When** I click the "Instant Idea" button
    3. **Then** a prompt appears to enter 2-3 ingredients.
    4. **And** an immediate AI-generated recipe suggestion is provided based on my input.
    5. **And** this action does not modify my inventory.
  </acceptanceCriteria>
  <artifacts>
    <docs>
        <doc>
            <path>docs/sprint-artifacts/tech-spec-epic-4.md</path>
            <title>Epic Technical Specification: Personalized Suggestions &amp; Alerts</title>
            <section>APIs and Interfaces</section>
            <snippet>Endpoint: POST /api/instant-idea. Generates a recipe from a string of ingredients using the Google Gemini API.</snippet>
        </doc>
        <doc>
            <path>docs/PRD.md</path>
            <title>ibe160 - Product Requirements Document</title>
            <section>FR4.2 - Instant Idea Generation</section>
            <snippet>A user can get an immediate recipe suggestion without using their saved inventory. A prominent 'Instant Idea' button is available on the main screen.</snippet>
        </doc>
        <doc>
            <path>docs/architecture.md</path>
            <title>Architecture</title>
            <section>AI Application Integration</section>
            <snippet>Spoonacular API for core recipe data; Google Gemini for generative AI features</snippet>
        </doc>
        <doc>
            <path>docs/ux-design-specification.md</path>
            <title>UX Design Specification</title>
            <section>2.2 Novel UX Patterns</section>
            <snippet>Instant Idea Button (FR4.2): A dedicated, always-accessible primary button/modal for zero-friction recipe generation.</snippet>
        </doc>
        <doc>
            <path>docs/epics.md</path>
            <title>Epic Breakdown</title>
            <section>Epic 4: Personalized Suggestions &amp; Alerts</section>
            <snippet>Story 4.4: Instant Idea Generation - As a user, I want to quickly get a recipe suggestion by typing a few ingredients, without affecting my persistent inventory, so that I can get an instant meal idea.</snippet>
        </doc>
    </docs>
    <code>
        <artifact>
            <path>app/api/recipes/instant-idea/route.ts</path>
            <kind>api-route</kind>
            <symbol>POST</symbol>
            <lines>N/A (new file)</lines>
            <reason>Backend logic for the Instant Idea feature, will call the Gemini API.</reason>
        </artifact>
        <artifact>
            <path>components/specific/InstantIdeaButton.tsx</path>
            <kind>ui-component</kind>
            <symbol>InstantIdeaButton</symbol>
            <lines>N/A (new file)</lines>
            <reason>The main button to trigger the Instant Idea flow.</reason>
        </artifact>
        <artifact>
            <path>components/specific/InstantIdeaModal.tsx</path>
            <kind>ui-component</kind>
            <symbol>InstantIdeaModal</symbol>
            <lines>N/A (new file)</lines>
            <reason>Modal to get user input for the ingredients.</reason>
        </artifact>
    </code>
    <dependencies>
        <dependency>
            <name>next</name>
            <version>16+</version>
        </dependency>
        <dependency>
            <name>@google/generative-ai</name>
            <version>Latest Stable</version>
        </dependency>
    </dependencies>
  </artifacts>
  <constraints>
    - AI Application Integration: Google Gemini for generative AI features.
    - The feature must not interact with the user's persistent inventory.
  </constraints>
  <interfaces>
    <interface>
      <name>POST /api/recipes/instant-idea</name>
      <kind>REST endpoint</kind>
      <signature>POST /api/recipes/instant-idea</signature>
      <path>app/api/recipes/instant-idea/route.ts</path>
    </interface>
  </interfaces>
  <tests>
    <standards>Multi-layered strategy including Unit Tests (`Jest`, `React Testing Library`), Integration Tests (API routes, database interactions), and End-to-End (E2E) Tests (`Playwright`, `Cypress`), focusing on user-centric scenarios.</standards>
    <locations>
      - `tests/`
    </locations>
    <ideas>
        - (Integration) Test the `/api/recipes/instant-idea` route, mocking the Gemini API call.
        - (Component) Test the "Instant Idea" button and modal components.
        - (E2E) Test the entire flow from clicking the button to seeing a recipe.
    </ideas>
  </tests>
</story-context>